---
const pathname = Astro.url?.pathname ?? "/";
import Icon from "./icon.astro";

type NavItem = { href: string; label: string; icon: "home" | "pen" | "image" | "stack" };

const navItems: NavItem[] = [
  { href: "/", label: "Home", icon: "home" },
  { href: "/blog", label: "Writing", icon: "pen" },
  { href: "/gallery", label: "Gallery", icon: "image" },
  { href: "/tech-stack", label: "Tech Stack", icon: "stack" },
];

const isActive = (href: string) => {
  if (href === "/") return pathname === "/";
  return pathname === href || pathname.startsWith(`${href}/`);
};
---

<a
  href="#main-content"
  class="sr-only focus:not-sr-only focus:fixed focus:top-3 focus:left-3 focus:z-[60] focus:px-3 focus:py-2 focus:rounded-md focus:bg-background focus:text-foreground focus:border focus:border-border"
>
  Skip to content
</a>

<header class="sticky top-0 z-50 w-full border-b border-border bg-background/85 backdrop-blur">
  <div class="mx-auto max-w-6xl px-6 h-14 flex items-center justify-between gap-4">
    <a href="/" class="inline-flex items-center gap-2.5 font-semibold tracking-tight hover:opacity-80 transition-opacity text-base sm:text-lg">
      <img
        src="/images/icon.png"
        alt="Site icon"
        width="28"
        height="28"
        class="w-7 h-7 rounded-md"
        loading="eager"
        decoding="async"
      />
      Daksh Agrawal
    </a>

    <!-- Desktop nav -->
    <nav class="hidden md:flex items-center gap-1" aria-label="Primary navigation">
      {navItems.map((item) => (
        <a
          href={item.href}
          aria-current={isActive(item.href) ? "page" : undefined}
          class:list={[
            "px-3 py-2 rounded-md text-sm font-medium transition-colors inline-flex items-center gap-2",
            isActive(item.href)
              ? "bg-secondary text-secondary-foreground"
              : "text-muted-foreground hover:text-foreground hover:bg-secondary/60",
          ]}
        >
          <Icon name={item.icon} class="w-4 h-4" />
          {item.label}
        </a>
      ))}
    </nav>

    <div class="flex items-center gap-2">
      <a
        href="mailto:dakshagrawalx@gmail.com"
        class="hidden sm:inline-flex items-center gap-2 px-3 py-2 rounded-md bg-primary text-primary-foreground hover:bg-primary/90 transition-colors text-sm font-medium"
      >
        <Icon name="mail" class="w-4 h-4" />
        Email me
      </a>

      <!-- Mobile menu (no JS) -->
      <details class="md:hidden relative">
        <summary class="list-none cursor-pointer select-none px-3 py-2 rounded-md bg-secondary text-secondary-foreground hover:bg-secondary/80 transition-colors text-sm font-medium">
          <span class="inline-flex items-center gap-2">
            <Icon name="menu" class="w-4 h-4" />
            Menu
          </span>
        </summary>
        <div class="absolute right-0 mt-2 w-56 rounded-lg border border-border bg-background shadow-lg overflow-hidden">
          <nav class="p-2 flex flex-col gap-1" aria-label="Mobile navigation">
            {navItems.map((item) => (
              <a
                href={item.href}
                aria-current={isActive(item.href) ? "page" : undefined}
                class:list={[
                  "px-3 py-2 rounded-md text-sm font-medium transition-colors inline-flex items-center gap-2",
                  isActive(item.href)
                    ? "bg-secondary text-secondary-foreground"
                    : "text-muted-foreground hover:text-foreground hover:bg-secondary/60",
                ]}
              >
                <Icon name={item.icon} class="w-4 h-4" />
                {item.label}
              </a>
            ))}
            <div class="my-1 border-t border-border"></div>
            <a
              href="mailto:dakshagrawalx@gmail.com"
              class="px-3 py-2 rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 transition-colors inline-flex items-center gap-2"
            >
              <Icon name="mail" class="w-4 h-4" />
              Email me
            </a>

            <a
              href="/Daksh_Agrawal_Resume.pdf"
              download
              class="px-3 py-2 rounded-md text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-secondary/60 transition-colors inline-flex items-center gap-2"
            >
              <Icon name="download" class="w-4 h-4" />
              Download CV
            </a>
          </nav>
        </div>
      </details>
    </div>
  </div>
</header>


